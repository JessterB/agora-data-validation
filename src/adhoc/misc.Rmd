---
title: "misc investigations"
output: html_notebook
---

```{r eval=FALSE, echo=FALSE}
source("~/repos/rstudio/agora-data-validation/src/utils.R")
prepare()
```






## missing nominated target fields
```{r}
nominations_source <- download_file("syn12540368", type="csv")
```


```{r}
rest <- nominations_source[nominations_source$ensembl_gene_id == 'ENSG00000084093',]
```

```{r}
cols <- colnames(nominations_source)

# no empty strings
nominations_source[nominations_source$Source == "",]
nominations_source[nominations_source$Team == "",]
nominations_source[nominations_source$Rank == "",]
nominations_source[nominations_source$ensembl_gene_id == "",]
nominations_source[nominations_source$hgnc_symbol == "",]
nominations_source[nominations_source$Target_Choice_Justification == "",]
nominations_source[nominations_source$Predicted_Therapeutic_Direction == "",]
nominations_source[nominations_source$input_data == "",] 
nominations_source[nominations_source$initial_nomination == "",]


# empty strings
nominations_source[nominations_source$Data_used_to_support_target_selection == "",] # REST, HDAC1
nominations_source[nominations_source$data_synapseID == "",] # REST, HDAC1, NECTIN2, NGFR
nominations_source[nominations_source$study == "",]  # REST, HDAC1
nominations_source[nominations_source$Validation.study.details == "",] # 104 genes





```




## TMT proteomics source investigation
```{r}
proteomics_source <- download_file("syn18689335", type = "csv")
```


```{r}
tmt_source <- download_file("syn21266454", type = "csv")
```

```{r}
colnames(tmt_source)
```



genes with no ME but have DE?

```{r}
t3 <- gene_info_new[gene_info_new$hgnc_symbol == 'TUBAL3',]

gene_info_new[gene_info_new$medianexpression == NULL,]
```




genes with no RNA but Prot?


genes with no RNA but Metab?















```{r}
#stats_file <- download_file("syn27211878", "stats_file", "csv")
#median_file <- download_file("syn12514804", "median_file", "csv")
harmonized_targets <- download_file("syn12540368", "harmonized_targets_file", "csv")
```



how many genes will pull names from RNA DE results instead of geneInfo?
=> 1128



```{r}
blank_hgnc <- gene_info_new[gene_info_new$hgnc_symbol == '',]
ensgs <- blank_hgnc$ensembl_gene_id
rna_seqs <- rna_seq_differential_expression_new[rna_seq_differential_expression_new$ensembl_gene_id %in% ensgs,]
hgnc <- rna_seqs[!rna_seqs$hgnc_symbol == '',]
unique_hgnc <- unique(hgnc$ensembl_gene_id)
print(hgnc[order(hgnc$hgnc_symbol),])
print(unique_hgnc)
```
```{r}
hgnc[hgnc$ensembl_gene_id == 'ENSG00000273036',]
```


Total expected nominations 
```{r}
unique(harmonized_targets$hgnc_symbol)
length(unique(harmonized_targets$hgnc_symbol))
```

Two new nominations
```{r}
ngfr <- harmonized_targets[harmonized_targets$hgnc_symbol == "NGFR",]
nectin2 <- harmonized_targets[harmonized_targets$hgnc_symbol == "NECTIN2",]
print(ngfr)
print(nectin2)
```


```{r}
# find 10 genes that are in both files
# "CBE", "DLPFC", "FP", "IFG", "PHG", "STG", "TCX",

#median_ensgs <- median_file$ensembl_gene_id

  for (i in 1:10) {
    ensg <- median_ensgs[[i]]
    stats <- stats_file[stats_file$ensembl_gene_id == ensg,]
    median <- median_file[median_file$ensembl_gene_id == ensg,]
    
    for (tissue in c("CBE", "DLPFC", "FP", "IFG", "PHG", "STG", "TCX")) {
      tissue_stats <- stats[stats$tissue == tissue,]
      tissue_median <- median[median$tissue == tissue,]
      
      cat("\n", ensg, tissue, "\nStats: ", tissue_stats$medianLogCPM, tissue_stats$meanLogCPM,"\nMedian: ", tissue_median$ medianLogCPM)
      
    }
  }


```



Anna Greenwood (she/her)  12:25 PM
Just new rows. What is the best way to validate that the ENSEMBL ids and gene names are going to be compatable?
12:26
ENSG00000130202	NECTIN2
ENSG00000064300	NGFR

```{r}
gene_info_new[gene_info_new$ensembl_gene_id %in% c('ENSG00000130202', 'ENSG00000064300'),]

```


20 genes from adsp
```{r}


```